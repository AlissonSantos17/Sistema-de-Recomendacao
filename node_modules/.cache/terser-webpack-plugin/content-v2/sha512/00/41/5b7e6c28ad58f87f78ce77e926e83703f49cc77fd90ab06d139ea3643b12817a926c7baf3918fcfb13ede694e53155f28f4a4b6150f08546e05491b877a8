{"code":"!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=5)}([function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.manuallyIncrementPromiseCounter=t.manuallyDecrementPromiseCounter=t.manuallyResetPromiseCounter=t.trackPromise=t.getCounter=t.promiseCounterUpdateEventId=t.emitter=void 0;var n=r(6),o=r(1),u=new n.Emitter;t.emitter=u;var i=\"promise-counter-update\";t.promiseCounterUpdateEventId=i;var a=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:0,enumerable:!0,configurable:!0,writable:!0}):e[t]=0,e}({},o.defaultArea);t.getCounter=function(e){return a[e]},t.trackPromise=function(e,t){t=t||o.defaultArea,f(t);var r=function(){return l(t)};return e.then(r,r),e};var f=function(e){c(e);var t=s(e);u.emit(i,t,e)},c=function(e){a[e]?a[e]++:a[e]=1},s=function(e){return 0<a[e]},l=function(e){0<a[e]&&p(e);var t=s(e);u.emit(i,t,e)},p=function(e){a[e]--};t.manuallyResetPromiseCounter=function(e){e=e||o.defaultArea,a[e]=0,u.emit(i,!1,e)},t.manuallyDecrementPromiseCounter=function(e){e=e||o.defaultArea,l(e)},t.manuallyIncrementPromiseCounter=function(e){e=e||o.defaultArea,f(e)}},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.defaultArea=void 0,t.defaultArea=\"default-area\"},function(e){e.exports=react},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.setupConfig=t.defaultConfig=void 0;var n=r(1),o={area:n.defaultArea,delay:0};t.defaultConfig=o,t.setupConfig=function(e){return{area:e&&e.area?e.area:n.defaultArea,delay:e&&e.delay?e.delay:0}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),Object.defineProperty(t,\"trackPromise\",{enumerable:!0,get:function(){return n.trackPromise}}),Object.defineProperty(t,\"manuallyResetPromiseCounter\",{enumerable:!0,get:function(){return n.manuallyResetPromiseCounter}}),Object.defineProperty(t,\"manuallyDecrementPromiseCounter\",{enumerable:!0,get:function(){return n.manuallyDecrementPromiseCounter}}),Object.defineProperty(t,\"manuallyIncrementPromiseCounter\",{enumerable:!0,get:function(){return n.manuallyIncrementPromiseCounter}}),Object.defineProperty(t,\"promiseTrackerHoc\",{enumerable:!0,get:function(){return o.promiseTrackerHoc}}),Object.defineProperty(t,\"usePromiseTracker\",{enumerable:!0,get:function(){return u.usePromiseTracker}});var n=r(0),o=r(7),u=r(8)},function(e,t,r){\"use strict\";r.r(t);var n=r(4);r.n(n);console.log({trackPromise:n.trackPromise})},function(e,t){\"use strict\";function r(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}Object.defineProperty(t,\"__esModule\",{value:!0}),t.Emitter=void 0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e)}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:\"emit\",value:function(e){if(!e)return this;for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=!0,u=!1,i=void 0;try{for(var a,f,c=this._e(e)[Symbol.iterator]();!(o=(a=c.next()).done);o=!0)(f=a.value).apply(f.ctx,[].concat(r)),1==f.off_event&&this.off(e,f)}catch(e){u=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(u)throw i}}return this}},{key:\"on\",value:function(e,t,r){return e?(t.ctx=r,this._e(e).push(t),this):this}},{key:\"once\",value:function(e,t,r){return e?(t.ctx=r,t.off_event=!0,this.on(e,t)):this}},{key:\"off\",value:function(e,t){if(!e)return this;if(!this[e])return this;var r=this._e(e);return t?(this[e]=r.filter((function(e){return e!=t})),this):(delete this[e],this)}},{key:\"_e\",value:function(e){return this[e]||(this[e]=[])}}]),e}();t.Emitter=n},function(e,t,r){\"use strict\";function n(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){return(o=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function u(){return(u=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function i(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,\"__esModule\",{value:!0}),t.promiseTrackerHoc=void 0;var s=function(e){if(e&&e.__esModule)return e;if(null===e||\"object\"!==o(e)&&\"function\"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=u?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(r(2)),l=r(0),p=r(3);t.promiseTrackerHoc=function(e){return function(t){function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,r),(t=function(e,t){return!t||\"object\"!==o(t)&&\"function\"!=typeof t?f(e):t}(this,a(r).call(this,e))).state={promiseInProgress:!1,internalPromiseInProgress:!1,config:(0,p.setupConfig)(e.config)},t.notifyPromiseInProgress=t.notifyPromiseInProgress.bind(f(t)),t.updateProgress=t.updateProgress.bind(f(t)),t.subscribeToCounterUpdate=t.subscribeToCounterUpdate.bind(f(t)),t}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(r,t),function(e,t,r){t&&i(e.prototype,t),r&&i(e,r)}(r,[{key:\"notifyPromiseInProgress\",value:function(){var e=this;0===this.state.config.delay?this.setState({promiseInProgress:!0}):setTimeout((function(){var t=!!(0<(0,l.getCounter)(e.state.config.area));e.setState({promiseInProgress:t})}),this.state.config.delay)}},{key:\"updateProgress\",value:function(e,t){this.setState({internalPromiseInProgress:e},t),e?this.notifyPromiseInProgress():this.setState({promiseInProgress:!1})}},{key:\"subscribeToCounterUpdate\",value:function(){var e=this;l.emitter.on(l.promiseCounterUpdateEventId,(function(t,r){e.state.config.area===r&&e.updateProgress(t)}))}},{key:\"componentDidMount\",value:function(){this.updateProgress(!!(0<(0,l.getCounter)(this.state.config.area)),this.subscribeToCounterUpdate)}},{key:\"componentWillUnmount\",value:function(){l.emitter.off(l.promiseCounterUpdateEventId)}},{key:\"render\",value:function(){return s.default.createElement(e,u({},this.props,{config:this.state.config,promiseInProgress:this.state.promiseInProgress}))}}]),r}(s.Component)}},function(e,t,r){\"use strict\";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)){var r=[],n=!0,o=!1,u=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,u=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw u}}return r}}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}Object.defineProperty(t,\"__esModule\",{value:!0}),t.usePromiseTracker=void 0;var o=function(e){return e&&e.__esModule?e:{default:e}}(r(2)),u=r(0),i=r(3);t.usePromiseTracker=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i.defaultConfig,t=o.default.useRef(!1);o.default.useEffect((function(){return t.current=!0,function(){return t.current=!1}}),[]);var r=o.default.useState((0,i.setupConfig)(e)),a=n(r,1),f=a[0];o.default.useEffect((function(){t.current&&f&&f.area&&0<(0,u.getCounter)(f.area)&&(p(!0),b(!0))}),[f]);var c=o.default.useState(!1),s=n(c,2),l=s[0],p=s[1],d=o.default.useState(!1),y=n(d,2),m=y[0],b=y[1],v=o.default.useRef(l),P=function(){f&&f.delay&&0!==f.delay?setTimeout((function(){v.current&&b(!0)}),f.delay):b(!0)},g=function(e,r){t.current&&f.area===r&&(p(e),v.current=e,e?P():b(!1))};return o.default.useEffect((function(){return v.current=l,u.emitter.on(u.promiseCounterUpdateEventId,g),function(){return u.emitter.off(u.promiseCounterUpdateEventId,g)}}),[]),{promiseInProgress:m}}}]);","extractedComments":[]}